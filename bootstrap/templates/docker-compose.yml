name: imanai-tap-services

services:
  ${newServiceName}:
    build:
      dockerfile: Dockerfile
      args:
        - GH_USERNAME=${GH_USERNAME}
        - GH_PACKAGES_READ_TOKEN=${GH_PACKAGES_READ_TOKEN}

    image: ghcr.io/${newRepo}:latest
    container_name: ${newServiceName}
    labels:
      service_type: application
      logger: loki
#    ports:
#      - "8080:8080"
#      - "15005:5005"   # JDWP debug
    environment:
      - SPRING_PROFILES_ACTIVE=compose
      - ENV=compose
      - OTLP_TRACING_ENDPOINT=http://alloy:4318/v1/traces
      - JAVA_TOOL_OPTIONS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005
    networks:
      - imanai-tap

networks:
  imanai-tap:
    external: true
